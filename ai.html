<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>CYBERMIND | ACTIVE LOADING</title>
    <style>
        :root { --neon: #00f2ff; --green: #39ff14; --dark: #05070a; --warn: #ffcc00; }
        body { background: var(--dark); color: #fff; font-family: 'Consolas', monospace; margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        
        /* Экран загрузки */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--dark); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: 0.5s; }
        .progress-container { width: 300px; height: 4px; background: #1a2a3a; margin: 20px; border-radius: 2px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: var(--neon); box-shadow: 0 0 10px var(--neon); transition: 0.3s; }
        
        /* Основной интерфейс */
        #terminal { flex: 1; padding: 20px; overflow-y: auto; font-size: 14px; color: #ccc; }
        .log { margin-bottom: 5px; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .controls { padding: 20px; background: #0a1016; display: flex; gap: 10px; border-top: 1px solid #1a2a3a; }
        input { flex: 1; background: #000; border: 1px solid #1a2a3a; color: var(--green); padding: 12px; outline: none; }
        button { background: var(--neon); color: #000; border: none; padding: 0 25px; cursor: pointer; font-weight: bold; }
        button:disabled { background: #333; cursor: not-allowed; }

        .system-text { color: var(--warn); font-size: 10px; }
    </style>
</head>
<body>

<div id="loader">
    <div style="letter-spacing: 5px; color: var(--neon);">СИНХРОНИЗАЦИЯ МОЗГОВ...</div>
    <div class="progress-container"><div id="progress-bar"></div></div>
    <div id="load-status" class="system-text">Инициализация модулей...</div>
</div>

<div id="terminal">
    <div class="log" style="color: var(--neon);">[SYSTEM]: Добро пожаловать, Создатель. Протокол 1234 активен.</div>
</div>

<div class="controls">
    <input type="text" id="userInput" placeholder="Пиши сюда..." disabled>
    <button id="sendBtn" onclick="process()" disabled>SEND</button>
</div>

<script type="module">
    import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1';

    const bar = document.getElementById('progress-bar');
    const status = document.getElementById('load-status');
    const loader = document.getElementById('loader');
    const input = document.getElementById('userInput');
    const btn = document.getElementById('sendBtn');

    let ai;

    // ШОУ ЗАГРУЗКИ
    async function init() {
        try {
            // Имитируем проверку железа для i5
            status.innerText = "Анализ CPU: Intel i5 обнаружен. Оптимизация потоков...";
            await new Promise(r => setTimeout(r, 1000));

            ai = await pipeline('text2text-generation', 'Xenova/LaMini-Flan-T5-78M', {
                progress_callback: (p) => {
                    const percent = Math.round(p.progress || 0);
                    bar.style.width = percent + '%';
                    status.innerText = `Загрузка нейронных связей: ${percent}% [${(p.loaded / 1024 / 1024).toFixed(1)}MB]`;
                    
                    if (percent > 20 && percent < 40) log("Подключение Logic Core...", "#555");
                    if (percent > 50 && percent < 70) log("Активация Creative Synapse...", "#555");
                    if (percent > 80) log("Сборка Integrator Unit...", "#555");
                }
            });

            // Убираем экран загрузки
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.style.display = 'none';
                input.disabled = false;
                btn.disabled = false;
                log(">>> ВСЕ СИСТЕМЫ ОНЛАЙН. МОЗГ СОБРАН.", "#39ff14");
            }, 500);

        } catch (e) {
            status.innerText = "ОШИБКА ЗАГРУЗКИ. Проверь интернет.";
            log("Критическая ошибка: " + e.message, "red");
        }
    }

    window.process = async () => {
        const text = input.value.trim();
        if(!text) return;
        
        log(`USER: ${text}`, "#fff");
        input.value = '';
        btn.disabled = true;

        log("... Думаю всеми частями мозга ...", "#444");
        
        // Нейронка отвечает
        const result = await ai(text, { max_new_tokens: 100, temperature: 0.7 });
        
        log(`CYBERMIND: ${result[0].generated_text}`, "#39ff14");
        btn.disabled = false;
    };

    function log(txt, color = "#ccc") {
        const t = document.getElementById('terminal');
        const d = document.createElement('div');
        d.className = 'log';
        d.style.color = color;
        d.innerText = `[${new Date().toLocaleTimeString()}] ${txt}`;
        t.appendChild(d);
        t.scrollTop = t.scrollHeight;
    }

    // Запуск процесса при открытии
    init();

    // Enter для ввода
    input.addEventListener("keypress", (e) => { if(e.key === "Enter") window.process(); });
</script>

</body>
</html>
