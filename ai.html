<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>CYBERMIND ULTIMATE ENGINE</title>
    <style>
        :root { --neon: #00f2ff; --green: #39ff14; --dark: #05070a; }
        body { background: var(--dark); color: #fff; font-family: 'Consolas', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        /* Дизайн терминала */
        #terminal { flex: 1; padding: 20px; overflow-y: auto; background: rgba(0,0,0,0.8); border: 1px solid #1a2a3a; margin: 10px; box-shadow: inset 0 0 20px #000; }
        .log-entry { margin-bottom: 8px; border-left: 2px solid #1a2a3a; padding-left: 10px; animation: blink 0.1s; }
        
        /* Модули */
        .modules-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; padding: 10px; }
        .module { border: 1px solid #1a2a3a; padding: 10px; font-size: 10px; text-align: center; color: #444; }
        .module.active { border-color: var(--neon); color: var(--neon); box-shadow: 0 0 10px rgba(0,242,255,0.2); }

        /* Ввод */
        .input-area { background: #0a0d14; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #1a2a3a; }
        input { flex: 1; background: #000; border: 1px solid #1a2a3a; color: var(--green); padding: 12px; font-family: inherit; outline: none; }
        button { background: transparent; border: 1px solid var(--neon); color: var(--neon); padding: 0 20px; cursor: pointer; text-transform: uppercase; }
        button:hover { background: var(--neon); color: #000; }
        button:disabled { border-color: #333; color: #333; }
    </style>
</head>
<body>

<div class="modules-grid">
    <div id="mod-logic" class="module">LOGIC_CORE</div>
    <div id="mod-creative" class="module">CREATIVE_SYNAPSE</div>
    <div id="mod-neural" class="module">NEURAL_TRANSFORMER</div>
    <div id="mod-integrator" class="module">INTEGRATOR_UNIT</div>
</div>

<div id="terminal">
    <div class="log-entry" style="color: var(--neon);">[SYSTEM]: Ожидание команды активации. Пароль подтвержден: 1234.</div>
</div>

<div class="input-area">
    <input type="text" id="userInput" placeholder="Введите запрос для нейронки..." disabled>
    <button id="bootBtn" onclick="bootAll()">АКТИВИРОВАТЬ</button>
    <button id="sendBtn" onclick="process()" disabled>SEND</button>
</div>

<script type="module">
    import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1';

    // --- МОДУЛЬ 1: LOGIC CORE ---
    const LogicCore = {
        analyze(text) {
            return { tokens: text.split(' ').length, complexity: text.length > 30 ? 0.9 : 0.4 };
        }
    };

    // --- МОДУЛЬ 2: CREATIVE CORE ---
    const CreativeCore = {
        style(text) {
            const styles = ["Технократ", "Философ", "Хакер"];
            return styles[text.length % 3];
        }
    };

    // --- МОДУЛЬ 3: NEURAL CORE (Самый тяжелый) ---
    let pipe = null;
    const NeuralCore = {
        async init(cb) {
            cb("Загрузка весов нейронки...");
            pipe = await pipeline('text2text-generation', 'Xenova/LaMini-Flan-T5-78M');
            return true;
        },
        async think(text) {
            const res = await pipe(text, { max_new_tokens: 60, temperature: 0.7 });
            return res[0].generated_text;
        }
    };

    // --- МОДУЛЬ 4: INTEGRATOR (Сборщик) ---
    window.bootAll = async () => {
        const btn = document.getElementById('bootBtn');
        btn.disabled = true;
        
        log("Запуск протокола синхронизации...", "#888");
        
        // Включаем модули по очереди
        const mods = ['mod-logic', 'mod-creative', 'mod-neural', 'mod-integrator'];
        for (let m of mods) {
            document.getElementById(m).classList.add('active');
            log(`Синхронизация ${m}... OK`, varColor(m));
            await new Promise(r => setTimeout(r, 400));
        }

        // Инициализация нейронки
        await NeuralCore.init(log);
        
        log(">>> НЕЙРОНКА СОБРАНА ИЗ ЧАСТЕЙ. Я СЛУШАЮ.", "#39ff14");
        document.getElementById('userInput').disabled = false;
        document.getElementById('sendBtn').disabled = false;
        btn.innerText = "ONLINE";
    };

    window.process = async () => {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if(!text) return;

        log(`USER: ${text}`, "#fff");
        input.value = '';

        // Работают все части одновременно
        const l = LogicCore.analyze(text);
        const c = CreativeCore.style(text);
        
        log(`[LOGIC]: Токенов: ${l.tokens}, Сложность: ${l.complexity}`, "#555");
        log(`[CREATIVE]: Стиль: ${c}`, "#555");
        log("... Нейронная сеть обрабатывает запрос ...", varColor('mod-neural'));

        const response = await NeuralCore.think(text);
        
        log(`[CYBERMIND]: ${response}`, "#39ff14");
    };

    function log(txt, color = "#ccc") {
        const t = document.getElementById('terminal');
        const d = document.createElement('div');
        d.className = 'log-entry';
        d.style.color = color;
        d.innerText = `[${new Date().toLocaleTimeString()}] ${txt}`;
        t.appendChild(d);
        t.scrollTop = t.scrollHeight;
    }

    function varColor(m) {
        if(m.includes('logic')) return '#00f2ff';
        if(m.includes('neural')) return '#ff00ff';
        return '#39ff14';
    }
</script>

</body>
</html>
