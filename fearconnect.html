<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>FearConnect Debug</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: #111; padding: 30px; border-radius: 20px; border: 1px solid #333; width: 300px; text-align: center; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid #444; color: #fff; border-radius: 8px; }
        button { width: 100%; padding: 12px; background: #ff3b30; border: none; color: #fff; font-weight: bold; border-radius: 8px; cursor: pointer; }
        #log { font-size: 10px; color: #777; margin-top: 15px; }
        #app { display:none; position: fixed; inset: 0; background: #000; padding: 20px; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="card">
        <h2>FEARCONNECT</h2>
        <input type="text" id="alog" placeholder="ID">
        <input type="password" id="apass" placeholder="PASSWORD">
        <button id="main-btn">ВОЙТИ / РЕГА</button>
        <div id="log">Статус: Ожидание нажатия...</div>
    </div>
</div>

<div id="app">
    <h1>Вы вошли как: <span id="my-id"></span></h1>
    <p>Если ты видишь это окно — всё работает!</p>
</div>

<script>
    const LOG = document.getElementById('log');
    const S_URL = "https://matvey228552858258489842494-fearconnect.hf.space";
    
    LOG.innerText = "Подключение к серверу...";
    
    // Инициализация сокета с обработкой ошибок
    const socket = io(S_URL, { 
        transports: ['websocket', 'polling'],
        timeout: 5000 
    });

    socket.on('connect', () => {
        LOG.innerText = "Статус: Соединение установлено!";
        LOG.style.color = "#4cd964";
    });

    socket.on('connect_error', (err) => {
        LOG.innerText = "Ошибка сети: Сервер недоступен";
        LOG.style.color = "#ff3b30";
        console.error(err);
    });

    document.getElementById('main-btn').onclick = function() {
        const login = document.getElementById('alog').value.trim();
        const pass = document.getElementById('apass').value.trim();
        
        if(!login || !pass) {
            alert("Введи данные!");
            return;
        }

        LOG.innerText = "Отправка запроса...";
        // Пытаемся и зарегаться и войти одновременно для теста
        socket.emit('auth', { login, pass, isReg: true });
    };

    socket.on('auth_success', (data) => {
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        document.getElementById('my-id').innerText = data.login;
    });

    socket.on('auth_error', (err) => {
        alert("Ошибка: " + err);
        LOG.innerText = "Статус: " + err;
    });
</script>
</body>
</html>
